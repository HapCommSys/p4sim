<a href="https://github.com/p4lang/gsoc/blob/main/2025/ideas_list.md#project-5" target="_blank">
  <img src="https://img.shields.io/badge/Program%20Google%20Summer%20of%20Code-2025-fbbc05?style=flat&logo=data%3Aimage%2Fpng%3Bbase64%2CiVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAMAAABHPGVmAAAALVBMVEVHcEz7vQD7vQD8vQD7vQD8vQD7vQD8vQD8vQD7vQD7vQD8vQD7vQD7vQD7vQAgxtLpAAAADnRSTlMAZvVQ6QrVPhl6oSmHvzL6LQUAAASGSURBVHjatdnZdusgDAVQELMY%2Fv9zb2%2Bwc%2BIKDzQLvTXB3gYBFqmaDVeKU4sCBlFyy43WqLjlBpR1BpR1BpR1xjoFxmIFBpSVBpSVBpSVBpSVBpQ1xvdK1oPgblhfOWltjNaJq7ddYT2IfImYJqMDrENUChGDZn%2FWQ%2FMHxBcD4BMyBc5XCHkNQTq60vfIgXAx5xByju6T8V8itsT3%2FUPi6r39Ce8rp%2FCWYrHfIDXs95FZJs%2FvTob6Z4T2buQE4eikvHeG%2FoZY7TpRfDsNWzrjtP0L4s12NYhh%2BO1ZjJ9HfOjdYGo3QZx7YvwEAgOPdx3eQJlArMFA3wXSZ%2BwMQvplJGoPY6sqNU0gxcGYUVx5jtSIx3oS6HysTxEbMMDPAmkM9iFSXnPXt8nwuQ%2FYI8TH%2F425TQe7%2FnBPEH2bECI6T4t%2Bgvh4N1istR50FJdeIX1Ek%2FqJdGGQOWmAa4u7rn18vuuIzUq52gbxvpiSuzIau%2BuO9FUUfTvvCjcoQ4MMltRnEOqF0pdD%2FwiBZWxoqGCn8r2VGKIUCHOoTyHK2g7y1bsJRRqNe3%2FlXv5GbNhWEWXxbsf1UITRF4kYcM4KiI%2FbeFIevNNq7P2EIg0bVL%2BfqCcyYV2rbDdExWSPjUPPGBRh9JTowTscW0Dqf%2BwLXGmPthgKKMJo1f1OSQ29hf1Mbdlmg5NFV1H7KoICA3mruIQ4vl4TTFhvuAlxxrdb1J55KMJoBatEPCv6mr3sJzK%2F9RQKDAx49Ji5ctSLwsxAxgyuiduOAeVtIG14zppPKtAka9lcMZz71IHyNoAcCpvIx6UfxGLleCim3ggUpe0dQhe7I86mWvQERZmCIocryAqPsdYOSQlVIjCgyMRbLSaXxi3GD4LEw4AipzCyyvS5a5ThMpJTGAYUuQljhiWL53R11FN5BxhQsK0UWbE747E7evGV2FaEAUWmDave0H4LQxg6nErl1IEBBRdmOzjkBPpdqFB%2BpUtUGb0tDKloZP44hQLthQoDwXYiXlowpMJIymExdARL8SViYzymhGEMFR%2FR3cOyNoRCpQcZFu1s6AsNhlQuSiJP%2B1Kk90dNRHW9BYyhwlszhNgdb05CjmGcKDb3DotAoYIYV9wWxjDSZcHNmN%2Fj0KpPm3R7dMjq7HlrSokvjIqjww3SEhb4XJDpg3CLvM9%2BPG%2FMHOcaOwzYRFScNe8QHJb9nOEDhvkGwV48eZC3BgfzWwSHZaXthKEVMvkMaQnKhKESzSCkJ37uQqlJ7RmCIcbr%2By5qUEjiIwQK3q4yZKHqYDxEUIo4U6%2BNahxKr0kEZwv8HC%2BDqo69UaI2ieBAujN2RNhOoPybQjBr9oNSKNXSoQ%2B2luCUQuk1iSCIg9oiZl24Vv8TtXLROaotAtO3%2F9ooWSFcjDnH6BQio2SZQSRz%2FpsPfsifQ2RY1tmNBM3oxQRCbRjkOZn%2FEACT2J%2B1vkZiGESyG1SZS%2FqJ1wTogE1hEFHNh9yNCbvvREwqCwwoawwoKw0oKw0oKw0oKw0oKw0oKw0oMFYqMFYqMFYqMBYq88Y%2FxB7wiOJRvWkAAAAASUVORK5CYII%3D" height="20"/>
</a>

# P4sim in ns-3 for Programmable Data Plane simulation

P4sim is a P4-driven network simulator aiming at combining P4, the state-of-the-art programmable data plane language and ns-3, one of the most popular network simulators. P4sim is an open-source project under Apache License 2.0.

P4sim with reference to behavioral models: [behavioral-model](https://github.com/p4lang/behavioral-model).

Our implementation was built upon the the P4-driven Network Simulator Module, as outlined in:
> Bai, Jiasong, Jun Bi, Peng Kuang, Chengze Fan, Yu Zhou, and Cheng Zhang. **"NS4: Enabling programmable data plane simulation."** In Proceedings of the Symposium on SDN Research, pp. 1-7. 2018. Available at [ACM DL](https://dl.acm.org/doi/abs/10.1145/3185467.3185470)

> Fan, Chengze, Jun Bi, Yu Zhou, Cheng Zhang, and Haisu Yu. **"NS4: A P4-driven network simulator."** In Proceedings of the SIGCOMM Posters and Demos, pp. 105-107. 2017. Available at [ACM DL](https://dl.acm.org/doi/10.1145/3123878.3132002)

⭐ More detail check our paper submitted on 21 March 2025: [P4sim: Programming Protocol-independent Packet Processors in ns-3](https://arxiv.org/abs/2503.17554)

## P4Sim: NS-3-Based P4 Simulation Environment

See [here](doc/vm-env.md).

## Simulation Parameters for P4 switch ##

In a P4 switch, the functionality is defined by the user's P4 program and the configuration of the flow table. But the following parameters can also be configured in ns-3 `ns3::P4SwitchNetDevice`.

| Parameter             | Description                                                         |
|-----------------------|----------------------------------------------------------------------|
| EnableTracing         | Enable or disable tracing in the switch                              |
| EnableSwap            | Enable or disable swapping of the P4 configuration                   |
| P4SwitchArch          | Switch architecture: 0 for v1model, 1 for PSA, 2 for PNA             |
| JsonPath              | Path to the compiled P4 JSON file (*.json)                           |
| FlowTablePath         | Path to the flow table configuration file                            |
| InputBufferSizeLow    | Input buffer size for low-priority packets (external packets)        |
| InputBufferSizeHigh   | Input buffer size for high-priority packets (internal packets)       |
| QueueBufferSize       | Total size of the queue buffer                                       |
| SwitchRate            | Switch processing rate in packets per second (pps)                   |
| ChannelType           | Channel type: 0 for CSMA, 1 for point-to-point (P2P), default is CSMA|

Note: 1. When using a CSMA channel, make sure the ARP packets are correctly handled in the P4 scripts.
    2. Buffer configuration only useful if the P4SwitchArch include that buffer.
    3. EnableTracing: The implementation is not yet complete and currently only supports basic measurements such as throughput.

## Simulation Examples: ##

See [here](doc/examples.md).

## Results Subdirectory ##



## Doxygen Documents ##

```bash
# install the doxygen, check the version
sudo apt update
sudo apt install doxygen graphviz dia
doxygen --version
# after install, reconfigure ns-3
./ns3 configure --enable-tests --enable-examples --enable-python-bindings
./ns3 build
./ns3 docs doxygen
# the doc will gene in ./doc/html/index.html
xdg-open build/doxygen/html/index.html

# PS: if using vm, could using the http server, add port forwarding in Vritualbox config.
# like port 127.0.0.1:2233 -> 8080
python3 -m http.server --directory ./doc/html 8080 # set in vm (remote)
http://127.0.0.1:2233 # open in local host
```
